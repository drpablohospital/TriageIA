============================================================
üîß ENTRENANDO MODELO PARA: ESPECIALIDAD
============================================================

üöÄ Iniciando entrenamiento para ESPECIALIDAD

‚öñÔ∏è Balanceando clases para ESPECIALIDAD...
Distribuci√≥n original: Counter({'URGENCIAS': 733, 'CIRUGIA': 396, 'ORTOPEDIA': 275, 'SIN ESPECIALIDAD': 229, 'OFTALMOLOGIA': 118, 'RECONSTRUCTIVA': 118, 'UROLOGIA': 78, 'OTORRINOLARINGOLOGIA': 70})
Nueva distribuci√≥n (1200 muestras): Counter({'SIN ESPECIALIDAD': 150, 'OTORRINOLARINGOLOGIA': 150, 'URGENCIAS': 150, 'ORTOPEDIA': 150, 'OFTALMOLOGIA': 150, 'CIRUGIA': 150, 'RECONSTRUCTIVA': 150, 'UROLOGIA': 150})
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at emilyalsentzer/Bio_ClinicalBERT and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.

‚è≥ Iniciando entrenamiento...
  0%|                                                                                                       | 0/600 [00:00<?, ?it/s]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 2.1023, 'grad_norm': 8.071603775024414, 'learning_rate': 2.94e-05, 'epoch': 0.42}
  8%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã                                                                                    | 50/600 [12:04<2:11:48, 14.38s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
{'eval_loss': 2.065385341644287, 'eval_kappa': 0.06190476190476191, 'eval_accuracy': 0.17916666666666667, 'eval_f1': 0.08949443621842329, 'eval_precision': 0.09307658210583743, 'eval_recall': 0.17916666666666667, 'eval_report': {'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '1': {'precision': 0.25, 'recall': 0.03333333333333333, 'f1-score': 0.058823529411764705, 'support': 30.0}, '2': {'precision': 0.125, 'recall': 0.06666666666666667, 'f1-score': 0.08695652173913043, 'support': 30.0}, '3': {'precision': 0.19230769230769232, 'recall': 0.5, 'f1-score': 0.2777777777777778, 'support': 30.0}, '4': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '5': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '6': {'precision': 0.1773049645390071, 'recall': 0.8333333333333334, 'f1-score': 0.29239766081871343, 'support': 30.0}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, 'accuracy': 0.17916666666666667, 'macro avg': {'precision': 0.09307658210583743, 'recall': 0.17916666666666667, 'f1-score': 0.08949443621842329, 'support': 240.0}, 'weighted avg': {'precision': 0.09307658210583743, 'recall': 0.17916666666666667, 'f1-score': 0.08949443621842329, 'support': 240.0}}, 'eval_runtime': 102.6396, 'eval_samples_per_second': 2.338, 'eval_steps_per_second': 0.146, 'epoch': 0.42}
{'loss': 2.0919, 'grad_norm': 7.59521484375, 'learning_rate': 2.7327272727272726e-05, 'epoch': 0.83}
 17%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè                                                                           | 100/600 [25:57<2:05:55, 15.11s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
                                                                                                                                    C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
{'eval_loss': 1.9795913696289062, 'eval_kappa': 0.12380952380952381, 'eval_accuracy': 0.23333333333333334, 'eval_f1': 0.18080517267882762, 'eval_precision': 0.2958369755244756, 'eval_recall': 0.23333333333333334, 'eval_report': {'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '1': {'precision': 1.0, 'recall': 0.6, 'f1-score': 0.75, 'support': 30.0}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '4': {'precision': 0.13942307692307693, 'recall': 0.9666666666666667, 'f1-score': 0.24369747899159663, 'support': 30.0}, '5': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 30.0}, '6': {'precision': 0.5, 'recall': 0.03333333333333333, 'f1-score': 0.0625, 'support': 30.0}, '7': {'precision': 0.7272727272727273, 'recall': 0.26666666666666666, 'f1-score': 0.3902439024390244, 'support': 30.0}, 'accuracy': 0.23333333333333334, 'macro avg': {'precision': 0.2958369755244755, 'recall': 0.23333333333333334, 'f1-score': 0.18080517267882762, 'support': 240.0}, 'weighted avg': {'precision': 0.2958369755244756, 'recall': 0.23333333333333334, 'f1-score': 0.18080517267882762, 'support': 240.0}}, 'eval_runtime': 105.1189, 'eval_samples_per_second': 2.283, 'eval_steps_per_second': 0.143, 'epoch': 0.83}
 20%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè                                                                        | 120/600 [32:43<1:58:40, 14.83s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 1.7714, 'grad_norm': 9.687296867370605, 'learning_rate': 2.4599999999999998e-05, 'epoch': 1.25}
{'eval_loss': 1.5614604949951172, 'eval_kappa': 0.4476190476190476, 'eval_accuracy': 0.5166666666666667, 'eval_f1': 0.47589296805869036, 'eval_precision': 0.5332161297419765, 'eval_recall': 0.5166666666666667, 'eval_report': {'0': {'precision': 0.48148148148148145, 'recall': 0.43333333333333335, 'f1-score': 0.45614035087719296, 'support': 30.0}, '1': {'precision': 0.627906976744186, 'recall': 0.9, 'f1-score': 0.7397260273972602, 'support': 30.0}, '2': {'precision': 0.5333333333333333, 'recall': 0.26666666666666666, 'f1-score': 0.35555555555555557, 'support': 30.0}, '3': {'precision': 0.8, 'recall': 0.4, 'f1-score': 0.5333333333333333, 'support': 30.0}, '4': {'precision': 0.6521739130434783, 'recall': 0.5, 'f1-score': 0.5660377358490566, 'support': 30.0}, '5': {'precision': 0.4, 'recall': 0.6666666666666666, 'f1-score': 0.5, 'support': 30.0}, '6': {'precision': 0.3333333333333333, 'recall': 0.03333333333333333, 'f1-score': 0.06060606060606061, 'support': 30.0}, '7': {'precision': 0.4375, 'recall': 0.9333333333333333, 'f1-score': 0.5957446808510638, 'support': 30.0}, 'accuracy': 0.5166666666666667, 'macro avg': {'precision': 0.5332161297419766, 'recall': 0.5166666666666666, 'f1-score': 0.47589296805869036, 'support': 240.0}, 'weighted avg': {'precision': 0.5332161297419765, 'recall': 0.5166666666666667, 'f1-score': 0.47589296805869036, 'support': 240.0}}, 'eval_runtime': 88.3851, 'eval_samples_per_second': 2.715, 'eval_steps_per_second': 0.17, 'epoch': 1.25}
{'loss': 1.3274, 'grad_norm': 12.409808158874512, 'learning_rate': 2.1872727272727274e-05, 'epoch': 1.67}
 33%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé                                                            | 200/600 [51:44<1:19:50, 11.98s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'eval_loss': 1.192720890045166, 'eval_kappa': 0.5666666666666667, 'eval_accuracy': 0.6208333333333333, 'eval_f1': 0.5789640940015144, 'eval_precision': 0.6622365607169161, 'eval_recall': 0.6208333333333333, 'eval_report': {'0': {'precision': 0.6333333333333333, 'recall': 0.6333333333333333, 'f1-score': 0.6333333333333333, 'support': 30.0}, '1': {'precision': 0.9, 'recall': 0.9, 'f1-score': 0.9, 'support': 30.0}, '2': {'precision': 0.75, 'recall': 0.1, 'f1-score': 0.17647058823529413, 'support': 30.0}, '3': {'precision': 0.7241379310344828, 'recall': 0.7, 'f1-score': 0.711864406779661, 'support': 30.0}, '4': {'precision': 0.4057971014492754, 'recall': 0.9333333333333333, 'f1-score': 0.5656565656565656, 'support': 30.0}, '5': {'precision': 0.5294117647058824, 'recall': 0.6, 'f1-score': 0.5625, 'support': 30.0}, '6': {'precision': 0.5714285714285714, 'recall': 0.13333333333333333, 'f1-score': 0.21621621621621623, 'support': 30.0}, '7': {'precision': 0.7837837837837838, 'recall': 0.9666666666666667, 'f1-score': 0.8656716417910447, 'support': 30.0}, 'accuracy': 0.6208333333333333, 'macro avg': {'precision': 0.6622365607169161, 'recall': 0.6208333333333333, 'f1-score': 0.5789640940015144, 'support': 240.0}, 'weighted avg': {'precision': 0.6622365607169161, 'recall': 0.6208333333333333, 'f1-score': 0.5789640940015144, 'support': 240.0}}, 'eval_runtime': 85.8616, 'eval_samples_per_second': 2.795, 'eval_steps_per_second': 0.175, 'epoch': 1.67}
 40%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå                                                     | 240/600 [1:02:01<1:14:04, 12.35s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 1.0845, 'grad_norm': 11.224769592285156, 'learning_rate': 1.9145454545454546e-05, 'epoch': 2.08}
{'eval_loss': 1.009095311164856, 'eval_kappa': 0.6047619047619048, 'eval_accuracy': 0.6541666666666667, 'eval_f1': 0.6186603197853787, 'eval_precision': 0.6617232550907345, 'eval_recall': 0.6541666666666667, 'eval_report': {'0': {'precision': 0.5897435897435898, 'recall': 0.7666666666666667, 'f1-score': 0.6666666666666666, 'support': 30.0}, '1': {'precision': 0.9032258064516129, 'recall': 0.9333333333333333, 'f1-score': 0.9180327868852459, 'support': 30.0}, '2': {'precision': 0.46808510638297873, 'recall': 0.7333333333333333, 'f1-score': 0.5714285714285714, 'support': 30.0}, '3': {'precision': 0.627906976744186, 'recall': 0.9, 'f1-score': 0.7397260273972602, 'support': 30.0}, '4': {'precision': 0.9, 'recall': 0.3, 'f1-score': 0.45, 'support': 30.0}, '5': {'precision': 0.6666666666666666, 'recall': 0.5333333333333333, 'f1-score': 0.5925925925925926, 'support': 30.0}, '6': {'precision': 0.375, 'recall': 0.1, 'f1-score': 0.15789473684210525, 'support': 30.0}, '7': {'precision': 0.7631578947368421, 'recall': 0.9666666666666667, 'f1-score': 0.8529411764705882, 'support': 30.0}, 'accuracy': 0.6541666666666667, 'macro avg': {'precision': 0.6617232550907346, 'recall': 0.6541666666666667, 'f1-score': 0.6186603197853788, 'support': 240.0}, 'weighted avg': {'precision': 0.6617232550907345, 'recall': 0.6541666666666667, 'f1-score': 0.6186603197853787, 'support': 240.0}}, 'eval_runtime': 92.0845, 'eval_samples_per_second': 2.606, 'eval_steps_per_second': 0.163, 'epoch': 2.08}
{'loss': 0.7702, 'grad_norm': 10.7706298828125, 'learning_rate': 1.641818181818182e-05, 'epoch': 2.5}
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå                                            | 300/600 [1:17:05<1:08:25, 13.68s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'eval_loss': 0.9296802878379822, 'eval_kappa': 0.6428571428571428, 'eval_accuracy': 0.6875, 'eval_f1': 0.6565886991572382, 'eval_precision': 0.7011666116847469, 'eval_recall': 0.6875, 'eval_report': {'0': {'precision': 0.7586206896551724, 'recall': 0.7333333333333333, 'f1-score': 0.7457627118644068, 'support': 30.0}, '1': {'precision': 0.8709677419354839, 'recall': 0.9, 'f1-score': 0.8852459016393442, 'support': 30.0}, '2': {'precision': 0.875, 'recall': 0.23333333333333334, 'f1-score': 0.3684210526315789, 'support': 30.0}, '3': {'precision': 0.7222222222222222, 'recall': 0.8666666666666667, 'f1-score': 0.7878787878787878, 'support': 30.0}, '4': {'precision': 0.5510204081632653, 'recall': 0.9, 'f1-score': 0.6835443037974683, 'support': 30.0}, '5': {'precision': 0.5128205128205128, 'recall': 0.6666666666666666, 'f1-score': 0.5797101449275363, 'support': 30.0}, '6': {'precision': 0.46153846153846156, 'recall': 0.2, 'f1-score': 0.27906976744186046, 'support': 30.0}, '7': {'precision': 0.8571428571428571, 'recall': 1.0, 'f1-score': 0.9230769230769231, 'support': 30.0}, 'accuracy': 0.6875, 'macro avg': {'precision': 0.7011666116847468, 'recall': 0.6875, 'f1-score': 0.6565886991572383, 'support': 240.0}, 'weighted avg': {'precision': 0.7011666116847469, 'recall': 0.6875, 'f1-score': 0.6565886991572382, 'support': 240.0}}, 'eval_runtime': 107.7687, 'eval_samples_per_second': 2.227, 'eval_steps_per_second': 0.139, 'epoch': 2.5}
{'loss': 0.6802, 'grad_norm': 20.917678833007812, 'learning_rate': 1.3690909090909091e-05, 'epoch': 2.92}
 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                      | 350/600 [1:31:06<59:52, 14.37s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'eval_loss': 0.9022395014762878, 'eval_kappa': 0.680952380952381, 'eval_accuracy': 0.7208333333333333, 'eval_f1': 0.697668070233979, 'eval_precision': 0.7258094311139361, 'eval_recall': 0.7208333333333333, 'eval_report': {'0': {'precision': 0.6428571428571429, 'recall': 0.9, 'f1-score': 0.75, 'support': 30.0}, '1': {'precision': 0.9032258064516129, 'recall': 0.9333333333333333, 'f1-score': 0.9180327868852459, 'support': 30.0}, '2': {'precision': 0.6896551724137931, 'recall': 0.6666666666666666, 'f1-score': 0.6779661016949152, 'support': 30.0}, '3': {'precision': 0.65, 'recall': 0.8666666666666667, 'f1-score': 0.7428571428571429, 'support': 30.0}, '4': {'precision': 0.8064516129032258, 'recall': 0.8333333333333334, 'f1-score': 0.819672131147541, 'support': 30.0}, '5': {'precision': 0.9, 'recall': 0.3, 'f1-score': 0.45, 'support': 30.0}, '6': {'precision': 0.38095238095238093, 'recall': 0.26666666666666666, 'f1-score': 0.3137254901960784, 'support': 30.0}, '7': {'precision': 0.8333333333333334, 'recall': 1.0, 'f1-score': 0.9090909090909091, 'support': 30.0}, 'accuracy': 0.7208333333333333, 'macro avg': {'precision': 0.7258094311139361, 'recall': 0.7208333333333333, 'f1-score': 0.697668070233979, 'support': 240.0}, 'weighted avg': {'precision': 0.7258094311139361, 'recall': 0.7208333333333333, 'f1-score': 0.697668070233979, 'support': 240.0}}, 'eval_runtime': 110.1389, 'eval_samples_per_second': 2.179, 'eval_steps_per_second': 0.136, 'epoch': 2.92}
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç                                   | 360/600 [1:35:28<1:05:54, 16.48s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.561, 'grad_norm': 9.104361534118652, 'learning_rate': 1.0963636363636365e-05, 'epoch': 3.33}
{'eval_loss': 0.7755029201507568, 'eval_kappa': 0.7285714285714286, 'eval_accuracy': 0.7625, 'eval_f1': 0.7567261076728471, 'eval_precision': 0.762499197625599, 'eval_recall': 0.7625, 'eval_report': {'0': {'precision': 0.7105263157894737, 'recall': 0.9, 'f1-score': 0.7941176470588235, 'support': 30.0}, '1': {'precision': 0.9, 'recall': 0.9, 'f1-score': 0.9, 'support': 30.0}, '2': {'precision': 0.6129032258064516, 'recall': 0.6333333333333333, 'f1-score': 0.6229508196721312, 'support': 30.0}, '3': {'precision': 0.7428571428571429, 'recall': 0.8666666666666667, 'f1-score': 0.8, 'support': 30.0}, '4': {'precision': 0.96, 'recall': 0.8, 'f1-score': 0.8727272727272727, 'support': 30.0}, '5': {'precision': 0.5862068965517241, 'recall': 0.5666666666666667, 'f1-score': 0.576271186440678, 'support': 30.0}, '6': {'precision': 0.65, 'recall': 0.43333333333333335, 'f1-score': 0.52, 'support': 30.0}, '7': {'precision': 0.9375, 'recall': 1.0, 'f1-score': 0.967741935483871, 'support': 30.0}, 'accuracy': 0.7625, 'macro avg': {'precision': 0.762499197625599, 'recall': 0.7625, 'f1-score': 0.7567261076728471, 'support': 240.0}, 'weighted avg': {'precision': 0.762499197625599, 'recall': 0.7625, 'f1-score': 0.7567261076728471, 'support': 240.0}}, 'eval_runtime': 113.0582, 'eval_samples_per_second': 2.123, 'eval_steps_per_second': 0.133, 'epoch': 3.33}
{'loss': 0.434, 'grad_norm': 8.839728355407715, 'learning_rate': 8.236363636363636e-06, 'epoch': 3.75}
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé                      | 450/600 [1:59:46<35:33, 14.22s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'eval_loss': 0.7877063155174255, 'eval_kappa': 0.7428571428571429, 'eval_accuracy': 0.775, 'eval_f1': 0.7644843519219843, 'eval_precision': 0.7796412973649834, 'eval_recall': 0.775, 'eval_report': {'0': {'precision': 0.7222222222222222, 'recall': 0.8666666666666667, 'f1-score': 0.7878787878787878, 'support': 30.0}, '1': {'precision': 0.9655172413793104, 'recall': 0.9333333333333333, 'f1-score': 0.9491525423728814, 'support': 30.0}, '2': {'precision': 0.7096774193548387, 'recall': 0.7333333333333333, 'f1-score': 0.7213114754098361, 'support': 30.0}, '3': {'precision': 0.7297297297297297, 'recall': 0.9, 'f1-score': 0.8059701492537313, 'support': 30.0}, '4': {'precision': 0.84375, 'recall': 0.9, 'f1-score': 0.8709677419354839, 'support': 30.0}, '5': {'precision': 0.8571428571428571, 'recall': 0.4, 'f1-score': 0.5454545454545454, 'support': 30.0}, '6': {'precision': 0.5, 'recall': 0.4666666666666667, 'f1-score': 0.4827586206896552, 'support': 30.0}, '7': {'precision': 0.9090909090909091, 'recall': 1.0, 'f1-score': 0.9523809523809523, 'support': 30.0}, 'accuracy': 0.775, 'macro avg': {'precision': 0.7796412973649833, 'recall': 0.775, 'f1-score': 0.7644843519219842, 'support': 240.0}, 'weighted avg': {'precision': 0.7796412973649834, 'recall': 0.775, 'f1-score': 0.7644843519219843, 'support': 240.0}}, 'eval_runtime': 110.6304, 'eval_samples_per_second': 2.169, 'eval_steps_per_second': 0.136, 'epoch': 3.75}
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä                  | 480/600 [2:09:21<34:37, 17.31s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.4246, 'grad_norm': 14.323585510253906, 'learning_rate': 5.509090909090909e-06, 'epoch': 4.17}
{'eval_loss': 0.7456253170967102, 'eval_kappa': 0.7380952380952381, 'eval_accuracy': 0.7708333333333334, 'eval_f1': 0.7627654679703422, 'eval_precision': 0.767391011229053, 'eval_recall': 0.7708333333333334, 'eval_report': {'0': {'precision': 0.7105263157894737, 'recall': 0.9, 'f1-score': 0.7941176470588235, 'support': 30.0}, '1': {'precision': 0.9, 'recall': 0.9, 'f1-score': 0.9, 'support': 30.0}, '2': {'precision': 0.6388888888888888, 'recall': 0.7666666666666667, 'f1-score': 0.696969696969697, 'support': 30.0}, '3': {'precision': 0.7941176470588235, 'recall': 0.9, 'f1-score': 0.84375, 'support': 30.0}, '4': {'precision': 0.92, 'recall': 0.7666666666666667, 'f1-score': 0.8363636363636363, 'support': 30.0}, '5': {'precision': 0.6666666666666666, 'recall': 0.5333333333333333, 'f1-score': 0.5925925925925926, 'support': 30.0}, '6': {'precision': 0.5714285714285714, 'recall': 0.4, 'f1-score': 0.47058823529411764, 'support': 30.0}, '7': {'precision': 0.9375, 'recall': 1.0, 'f1-score': 0.967741935483871, 'support': 30.0}, 'accuracy': 0.7708333333333334, 'macro avg': {'precision': 0.767391011229053, 'recall': 0.7708333333333334, 'f1-score': 0.7627654679703423, 'support': 240.0}, 'weighted avg': {'precision': 0.767391011229053, 'recall': 0.7708333333333334, 'f1-score': 0.7627654679703422, 'support': 240.0}}, 'eval_runtime': 115.5761, 'eval_samples_per_second': 2.077, 'eval_steps_per_second': 0.13, 'epoch': 4.17}
{'loss': 0.2712, 'grad_norm': 21.47173500061035, 'learning_rate': 2.7818181818181817e-06, 'epoch': 4.58}
 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç       | 550/600 [2:29:31<12:33, 15.06s/it]C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'eval_loss': 0.7171174883842468, 'eval_kappa': 0.7428571428571429, 'eval_accuracy': 0.775, 'eval_f1': 0.7679838991681629, 'eval_precision': 0.7683751392708036, 'eval_recall': 0.775, 'eval_report': {'0': {'precision': 0.75, 'recall': 0.9, 'f1-score': 0.8181818181818182, 'support': 30.0}, '1': {'precision': 0.9310344827586207, 'recall': 0.9, 'f1-score': 0.9152542372881356, 'support': 30.0}, '2': {'precision': 0.6666666666666666, 'recall': 0.7333333333333333, 'f1-score': 0.6984126984126984, 'support': 30.0}, '3': {'precision': 0.7941176470588235, 'recall': 0.9, 'f1-score': 0.84375, 'support': 30.0}, '4': {'precision': 0.8928571428571429, 'recall': 0.8333333333333334, 'f1-score': 0.8620689655172413, 'support': 30.0}, '5': {'precision': 0.6363636363636364, 'recall': 0.4666666666666667, 'f1-score': 0.5384615384615384, 'support': 30.0}, '6': {'precision': 0.5384615384615384, 'recall': 0.4666666666666667, 'f1-score': 0.5, 'support': 30.0}, '7': {'precision': 0.9375, 'recall': 1.0, 'f1-score': 0.967741935483871, 'support': 30.0}, 'accuracy': 0.775, 'macro avg': {'precision': 0.7683751392708035, 'recall': 0.775, 'f1-score': 0.7679838991681629, 'support': 240.0}, 'weighted avg': {'precision': 0.7683751392708036, 'recall': 0.775, 'f1-score': 0.7679838991681629, 'support': 240.0}}, 'eval_runtime': 106.0647, 'eval_samples_per_second': 2.263, 'eval_steps_per_second': 0.141, 'epoch': 4.58}
 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç       | 550/600 [2:31:17<12:33, 15.06s/it]
‚èπÔ∏è Sin mejora en Kappa por 2 evaluaciones. Deteniendo...‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 15/15 [01:40<00:00,  6.56s/it]
{'train_runtime': 9084.1952, 'train_samples_per_second': 0.528, 'train_steps_per_second': 0.066, 'train_loss': 1.0471622623096812, 'epoch': 4.58}
 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç       | 550/600 [2:31:24<13:45, 16.52s/it]
C:\Users\xiute\Desktop\TriageIA\venv\lib\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 15/15 [01:43<00:00,  7.29s/it]
‚èπÔ∏è Sin mejora en Kappa por 2 evaluaciones. Deteniendo...
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 15/15 [01:43<00:00,  6.88s/it]

üìä Resultados finales para ESPECIALIDAD:
‚ñ∫ Kappa: 0.743
‚ñ∫ Accuracy: 0.775
‚ñ∫ F1-Score: 0.764
‚ñ∫ Precision: 0.780
‚ñ∫ Recall: 0.775
‚ñ∫ Loss: 0.788

üìù Reporte de Clasificaci√≥n Detallado:

üîπ Clase 0:
   precision: 0.722
      recall: 0.867
    f1-score: 0.788
     support: 30.000

üîπ Clase 1:
   precision: 0.966
      recall: 0.933
    f1-score: 0.949
     support: 30.000

üîπ Clase 2:
   precision: 0.710
      recall: 0.733
    f1-score: 0.721
     support: 30.000

üîπ Clase 3:
   precision: 0.730
      recall: 0.900
    f1-score: 0.806
     support: 30.000

üîπ Clase 4:
   precision: 0.844
      recall: 0.900
    f1-score: 0.871
     support: 30.000

üîπ Clase 5:
   precision: 0.857
      recall: 0.400
    f1-score: 0.545
     support: 30.000

üîπ Clase 6:
   precision: 0.500
      recall: 0.467
    f1-score: 0.483
     support: 30.000

üîπ Clase 7:
   precision: 0.909
      recall: 1.000
    f1-score: 0.952
     support: 30.000

üîπ Clase macro avg:
   precision: 0.780
      recall: 0.775
    f1-score: 0.764
     support: 240.000

üîπ Clase weighted avg:
   precision: 0.780
      recall: 0.775
    f1-score: 0.764
     support: 240.000

üìå RESUMEN FINAL DE M√âTRICAS:
Etiqueta     | Kappa  | Accuracy | F1     | Precision | Recall | Loss
--------------------------------------------------------------------------------
DERIVACION   | 0.817 | 0.878    | 0.875 | 0.879     | 0.878 | 0.333
ESPECIALIDAD | 0.743 | 0.775    | 0.764 | 0.780     | 0.775 | 0.788
(venv) PS C:\Users\xiute\Desktop\TriageIA> 